[
  {
    "objectID": "eda.html",
    "href": "eda.html",
    "title": "Exploratory Data Analysis",
    "section": "",
    "text": "Setting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n25/10/11 16:18:00 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n25/10/11 16:18:01 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.\n25/10/11 16:18:01 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.\n[Stage 1:&gt;                                                          (0 + 1) / 1]                                                                                25/10/11 16:18:09 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.\n\n\n+---------------------+-------------------+--------------------+--------------------+---------+-----------+--------+-------------------+--------------------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------------------+-------------------+------------------+--------------------+--------------------+--------------------+--------------------+-------------------------------+-------------------------+----------------------------------+----------------------+----------------------------+-----------------------+--------------------+--------------------+---------------+---------------+------------+------------------+-----------+---------------+\n|EDUCATION_LEVELS_NAME| MIN_EDULEVELS_NAME|EMPLOYMENT_TYPE_NAME|MIN_YEARS_EXPERIENCE|SALARY_TO|SALARY_FROM|  SALARY|          CITY_NAME|            MSA_NAME|STATE_NAME|         NAICS2_NAME|         NAICS3_NAME|         NAICS4_NAME|         NAICS5_NAME|         NAICS6_NAME|         SKILLS_NAME|SPECIALIZED_SKILLS_NAME|CERTIFICATIONS_NAME|COMMON_SKILLS_NAME|SOFTWARE_SKILLS_NAME|           ONET_NAME|LOT_CAREER_AREA_NAME| LOT_OCCUPATION_NAME|LOT_SPECIALIZED_OCCUPATION_NAME|LOT_OCCUPATION_GROUP_NAME|LOT_V6_SPECIALIZED_OCCUPATION_NAME|LOT_V6_OCCUPATION_NAME|LOT_V6_OCCUPATION_GROUP_NAME|LOT_V6_CAREER_AREA_NAME|          SOC_2_NAME|          SOC_3_NAME|     SOC_4_NAME|     SOC_5_NAME|REMOTE_GROUP|STATE_ABBREVIATION|AFFILIATION|MIDPOINT_SALARY|\n+---------------------+-------------------+--------------------+--------------------+---------+-----------+--------+-------------------+--------------------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------------------+-------------------+------------------+--------------------+--------------------+--------------------+--------------------+-------------------------------+-------------------------+----------------------------------+----------------------+----------------------------+-----------------------+--------------------+--------------------+---------------+---------------+------------+------------------+-----------+---------------+\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n|  No Education Listed|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|            Unknown|             Unknown|   Unknown|             Unknown|             Unknown|             Unknown|             Unknown|             Unknown|                NULL|                   NULL|               NULL|              NULL|                NULL|                NULL|                NULL|                NULL|                           NULL|                     NULL|                              NULL|                  NULL|                        NULL|                   NULL|                NULL|                NULL|           NULL|           NULL|      Onsite|           Unknown|       NULL|       108668.5|\n| [  \"No Education ...|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0| [Unknown City], UT|             Unknown|      Utah|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|    [  \"Positivity\"]|                     []|                 []|  [  \"Positivity\"]|                  []|Business Intellig...|Information Techn...|Business Intellig...|           Oracle Consultant...|     Business Intellig...|              Oracle Consultant...|  Business Intellig...|        Business Intellig...|   Information Techn...|Computer and Math...|Mathematical Scie...|Data Scientists|Data Scientists|      Onsite|                UT|        Red|       108668.5|\n| [  \"No Education ...|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0| [Unknown City], TX|             Unknown|     Texas|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|[  \"SAP Logistics...|   [  \"SAP Logistics...|                 []|                []|[  \"SAP Logistics...|Business Intellig...|Information Techn...|Business Intellig...|            SAP Analyst / Admin|     Business Intellig...|               SAP Analyst / Admin|  Business Intellig...|        Business Intellig...|   Information Techn...|Computer and Math...|Mathematical Scie...|Data Scientists|Data Scientists|      Onsite|                TX|        Red|       108668.5|\n| [  \"No Education ...|No Education Listed|           Full-Time|                 0.0|  52000.0|    39000.0| 45500.0|          Miami, FL|Miami-Fort Lauder...|   Florida|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|                  []|                     []|                 []|                []|                  []|Business Intellig...|Business Manageme...|Business / Manage...|           Business Analyst ...|        Business Analysis|              Business Analyst ...|  Business / Manage...|           Business Analysis|   Business Manageme...|Computer and Math...|Mathematical Scie...|Data Scientists|Data Scientists|      Onsite|                FL|        Red|        45500.0|\n| [  \"No Education ...|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|    Los Fresnos, TX|Brownsville-Harli...|     Texas|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|                  []|                     []|                 []|                []|                  []|Business Intellig...|Business Manageme...|Business / Manage...|           Business Analyst ...|        Business Analysis|              Business Analyst ...|  Business / Manage...|           Business Analysis|   Business Manageme...|Computer and Math...|Mathematical Scie...|Data Scientists|Data Scientists|      Onsite|                TX|        Red|       108668.5|\n| [  \"No Education ...|No Education Listed|           Full-Time|                 0.0| 130042.0|    87295.0|115024.0|Fort Lauderdale, FL|Miami-Fort Lauder...|   Florida|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|Unclassified Indu...|   [  \"Landscaping\"]|      [  \"Landscaping\"]|                 []|                []|                  []|Business Intellig...|Business Manageme...|Business / Manage...|           Business Analyst ...|        Business Analysis|              Business Analyst ...|  Business / Manage...|           Business Analysis|   Business Manageme...|Computer and Math...|Mathematical Scie...|Data Scientists|Data Scientists|      Onsite|                FL|        Red|       108668.5|\n+---------------------+-------------------+--------------------+--------------------+---------+-----------+--------+-------------------+--------------------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------------------+-------------------+------------------+--------------------+--------------------+--------------------+--------------------+-------------------------------+-------------------------+----------------------------------+----------------------+----------------------------+-----------------------+--------------------+--------------------+---------------+---------------+------------+------------------+-----------+---------------+\nonly showing top 15 rows\n\n\n\n\nExploring the Salary by State Political Affiliation\n\n\n[Stage 3:&gt;                                                          (0 + 1) / 1]                                                                                \n\n\n        \n        \n        \n\n\n                                                    \n\n\nThis data clearly shows that average salaries are slightly higher in Blue states vs Red States across nearly all NAICS2 categories. Professional, Scientific, and Technical Services appears to be about equal regardless of affiliation.\n\n\nExploring the minimum education level by political affiliation\n\n\n[Stage 11:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n+-----------+--------------------+-----+------------------+\n|AFFILIATION|  MIN_EDULEVELS_NAME|count|        avg_salary|\n+-----------+--------------------+-----+------------------+\n|       Blue|Ph.D. or professi...|   65|121177.26153846153|\n|       Blue|     Master's degree|  975|127811.44102564102|\n|        Red|Ph.D. or professi...|   45|101607.06666666667|\n|       Blue| No Education Listed|10313|117231.11810336469|\n|       Blue|    Associate degree| 1058|116931.42722117202|\n|        Red|  High school or GED| 1992|  97134.2093373494|\n|       Blue|  High school or GED| 1563| 99052.77095329495|\n|       Blue|   Bachelor's degree|18247|118800.53685537349|\n|        Red|   Bachelor's degree|21201|116179.15782274421|\n|        Red| No Education Listed|11088|114194.55952380953|\n|        Red|     Master's degree|  720|126568.86388888888|\n|        Red|    Associate degree| 1914|116796.46603970742|\n+-----------+--------------------+-----+------------------+\n\n\n\n[Stage 14:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n                                                    \n\n\nThis graph shows us the comparison of job postings by political affiliation and minimum education level. As you can see, red states have far more job postings for lower education levels such as High School, Associate Degree, or Bachelor’s degree, and blue states have more postings requiring a Master’s Degree or higher.\n\n\n                                                    \n\n\nThis figure tells us that despite red states having more job postings with education level requirements below a Master’s degree, the salaries in Blue states are higher for every single minimum education level. This could be attributed to a higher cost of living in most blue states.\n\n\nAI Jobs Analysis\n\n\n+-------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------------------+-----------+------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------+--------------------------------------------------------------+---------------------------------------+\n|MIN_EDULEVELS_NAME |LOT_OCCUPATION_NAME                  |SKILLS_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |SALARY  |STATE_ABBREVIATION|AFFILIATION|NAICS2_NAME                                     |NAICS3_NAME                                                                 |NAICS4_NAME                                                   |NAICS5_NAME                                                   |NAICS6_NAME                            |\n+-------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------------------+-----------+------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------+--------------------------------------------------------------+---------------------------------------+\n|No Education Listed|Business Intelligence Analyst        |[  \"Artificial Intelligence\",  \"Angular (Web Framework)\",  \"ClickUp (Software)\",  \"Cyber Defense\",  \"Cyber Security\",  \"Engineering Management\",  \"Front End Design\",  \"Manufacturing Execution System (MES)\",  \"Operations\",  \"Project Management\",  \"SAP Applications\",  \"Wax\"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |115024.0|TX                |Red        |Unclassified Industry                           |Unclassified Industry                                                       |Unclassified Industry                                         |Unclassified Industry                                         |Unclassified Industry                  |\n|Bachelor's degree  |Data / Data Mining Analyst           |[  \"Chemical Engineering\",  \"Mechanical Engineering\",  \"Power BI\",  \"Forecasting\",  \"Hydraulics\",  \"Data Science\",  \"Data Engineering\",  \"Spreadsheets\",  \"Cost Benefit Analysis\",  \"Communication\",  \"Python (Programming Language)\",  \"Oil and Gas\",  \"Data Analysis\",  \"Statistical Modeling\",  \"SQL (Programming Language)\",  \"Data Modeling\",  \"Mathematics\",  \"Data Visualization\",  \"Computer Science\"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |140400.0|TX                |Red        |Unclassified Industry                           |Unclassified Industry                                                       |Unclassified Industry                                         |Unclassified Industry                                         |Unclassified Industry                  |\n|No Education Listed|Business / Management Analyst        |[  \"Business Communication\",  \"Data Science\",  \"Business Concepts\",  \"Project Management\",  \"Business Process\",  \"Communication\",  \"Time Management\",  \"Product Management\",  \"Data Analysis\",  \"Marketing\",  \"Stakeholder Management\",  \"Market Research\",  \"Business Intelligence\",  \"Business Operations\",  \"Cyber Security\",  \"Organizational Skills\",  \"Willingness To Learn\",  \"User Experience (UX)\",  \"Sales\",  \"Software Development\",  \"Problem Solving\",  \"Teaching\",  \"Compensation Analysis\"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |115024.0|IN                |Red        |Unclassified Industry                           |Unclassified Industry                                                       |Unclassified Industry                                         |Unclassified Industry                                         |Unclassified Industry                  |\n|No Education Listed|Data / Data Mining Analyst           |[  \"Salesforce\",  \"Apache Hadoop\",  \"C++ (Programming Language)\",  \"Gamification\",  \"Business Objectives\",  \"Data Mining\",  \"Data Processing\",  \"Collibra (Software)\",  \"Project Management\",  \"Finance\",  \"Algorithms\",  \"Python (Programming Language)\",  \"Apache Spark\",  \"Dashboard\",  \"Decision Making\",  \"Wealth Management\",  \"Machine Learning\",  \"Predictive Modeling\",  \"Natural Language Processing (NLP)\",  \"Microsoft Excel\",  \"SAS (Software)\",  \"Data Governance\",  \"Artificial Intelligence\",  \"Innovation\",  \"Data Visualization\",  \"Tableau (Business Intelligence Software)\",  \"R (Programming Language)\",  \"SQL (Programming Language)\"]                                                                                                                                                                                                                                                                                                                                                     |115024.0|NY                |Blue       |Unclassified Industry                           |Unclassified Industry                                                       |Unclassified Industry                                         |Unclassified Industry                                         |Unclassified Industry                  |\n|Bachelor's degree  |Data / Data Mining Analyst           |[  \"Power BI\",  \"Programming Languages\",  \"Customer Experience Improvement\",  \"Self-Motivation\",  \"Data Science\",  \"Linux\",  \"Python (Programming Language)\",  \"Sustaining Engineering\",  \"Data Analysis\",  \"Program Process Monitoring\",  \"Java (Programming Language)\",  \"SQL (Programming Language)\",  \"Product Engineering\",  \"Data Collection\",  \"Design Studio\",  \"Amazon Web Services\",  \"Software Development\",  \"Product Quality (QA/QC)\",  \"Data Visualization\",  \"Tableau (Business Intelligence Software)\",  \"Computer Science\"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |71458.0 |WI                |Red        |Unclassified Industry                           |Unclassified Industry                                                       |Unclassified Industry                                         |Unclassified Industry                                         |Unclassified Industry                  |\n|Bachelor's degree  |Computer Systems Engineer / Architect|[  \"Inventory Staging\",  \"Relational Databases\",  \"Computer Engineering\",  \"Star Schema\",  \"Information Technology\",  \"Management\",  \"Management Information Systems\",  \"Agile Methodology\",  \"Process Improvement\",  \"Application Development\",  \"Erwin (Data Modeling Software)\",  \"Data Science\",  \"Data Warehousing\",  \"Metadata Management\",  \"Amazon Redshift\",  \"Data Architecture\",  \"Interpersonal Communications\",  \"Cost Benefit Analysis\",  \"Waterfall Methodology\",  \"Aurora (Operating System)\",  \"Communication\",  \"Textiles\",  \"Systems Development Life Cycle\",  \"Leadership\",  \"Information Systems\",  \"Data Quality\",  \"Data Analysis\",  \"Business Requirements\",  \"Extract Transform Load (ETL)\",  \"SQL (Programming Language)\",  \"Operational Data Store\",  \"Data Modeling\",  \"Machine Learning\",  \"Third Normal Form\",  \"Change Management\",  \"Mentorship\",  \"Business Administration\",  \"Document-Oriented Databases\",  \"Data Strategy\",  \"Computer Science\"]                             |147650.0|SD                |Red        |Unclassified Industry                           |Unclassified Industry                                                       |Unclassified Industry                                         |Unclassified Industry                                         |Unclassified Industry                  |\n|No Education Listed|Business / Management Analyst        |[  \"Information Retrieval\",  \"Research\",  \"Data Infrastructure\",  \"Business Analytics\",  \"Innovation\",  \"Experimental Design\",  \"Statistical Analysis\",  \"Data Mining\",  \"Automation\",  \"Data Science\",  \"Data Engineering\",  \"Amazon Redshift\",  \"Data Architecture\",  \"Timelines\",  \"Requirements Management\",  \"Python (Programming Language)\",  \"Leadership\",  \"Supply Chain\",  \"Machine Learning\",  \"Communication\",  \"Business Intelligence\",  \"SQL (Programming Language)\",  \"Scalability\",  \"Scripting\",  \"Amazon Web Services\",  \"Data Integrity\",  \"Extract Transform Load (ETL)\"]                                                                                                                                                                                                                                                                                                                                                                                                                     |160050.0|WA                |Blue       |Retail Trade                                    |Sporting Goods, Hobby, Musical Instrument, Book, and Miscellaneous Retailers|Other Miscellaneous Retailers                                 |All Other Miscellaneous Retailers                             |All Other Miscellaneous Retailers      |\n|No Education Listed|Business Intelligence Analyst        |[  \"Information Retrieval\",  \"Inventory Planning\",  \"Analytical Skills\",  \"Experimental Design\",  \"Statistical Analysis\",  \"Data Mining\",  \"Self-Motivation\",  \"Automation\",  \"Data Science\",  \"Supply Chain Optimization\",  \"Business Metrics\",  \"Data Engineering\",  \"Supply Chain Acumen\",  \"Innovation\",  \"Python (Programming Language)\",  \"Leadership\",  \"Data Analysis\",  \"Machine Learning\",  \"Communication\",  \"Business Intelligence\",  \"Detail Oriented\",  \"SQL (Programming Language)\",  \"Scalability\",  \"Scripting\",  \"Amazon Web Services\",  \"Product Description\",  \"Data Visualization\"]                                                                                                                                                                                                                                                                                                                                                                                                         |160050.0|WA                |Blue       |Retail Trade                                    |Sporting Goods, Hobby, Musical Instrument, Book, and Miscellaneous Retailers|Other Miscellaneous Retailers                                 |All Other Miscellaneous Retailers                             |All Other Miscellaneous Retailers      |\n|Bachelor's degree  |Data / Data Mining Analyst           |[  \"Certified Information System Auditor (CISA)\",  \"Apache Hadoop\",  \"Prioritization\",  \"Coaching\",  \"Planning\",  \"Certified Fraud Examiner\",  \"Statistical Analysis\",  \"Self-Motivation\",  \"Data Science\",  \"Finance\",  \"Certified Analytics Professional\",  \"Communication\",  \"Innovation\",  \"Python (Programming Language)\",  \"Forensic Sciences\",  \"Emerging Technologies\",  \"Decision Making\",  \"Data Analysis\",  \"SQL (Programming Language)\",  \"SAS (Software)\",  \"Certified Information Systems Security Professional\",  \"Certified Information Security Manager\",  \"Scripting\",  \"Power BI\",  \"SPSS (Statistical Software)\",  \"Data Visualization\",  \"R (Programming Language)\"]                                                                                                                                                                                                                                                                                                                        |140300.0|NC                |Red        |Professional, Scientific, and Technical Services|Professional, Scientific, and Technical Services                            |Accounting, Tax Preparation, Bookkeeping, and Payroll Services|Accounting, Tax Preparation, Bookkeeping, and Payroll Services|Offices of Certified Public Accountants|\n|Bachelor's degree  |Data / Data Mining Analyst           |[  \"Workflow Management\",  \"General Data Protection Regulation (GDPR)\",  \"Analytic Applications\",  \"Medical Records\",  \"Electronic Medical Record\",  \"Agile Methodology\",  \"Value-Based Care\",  \"Health Administration\",  \"Project Status Reports\",  \"Data Science\",  \"Data Management\",  \"Healthcare Industry Knowledge\",  \"Big Data\",  \"Statistical Modeling\",  \"Informatics\",  \"Scrum (Software Development)\",  \"Communication\",  \"Valid Driver's License\",  \"Listening Skills\",  \"Decision Making\",  \"Data Analysis\",  \"Customer Data Management\",  \"Data Cleansing\",  \"Fast Healthcare Interoperability Resources (FHIR)\",  \"Business Requirements\",  \"Investigation\",  \"Project Management\",  \"Data Modeling\",  \"Key Performance Indicators (KPIs)\",  \"Scalability\",  \"Technology Solutions\",  \"Health Insurance Portability And Accountability Act (HIPAA) Compliance\",  \"ASC X12 Standards\",  \"Power BI\",  \"Problem Solving\",  \"SQL (Programming Language)\",  \"Tableau (Business Intelligence Software)\"]|164600.0|PA                |Red        |Professional, Scientific, and Technical Services|Professional, Scientific, and Technical Services                            |Accounting, Tax Preparation, Bookkeeping, and Payroll Services|Accounting, Tax Preparation, Bookkeeping, and Payroll Services|Offices of Certified Public Accountants|\n+-------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------------------+-----------+------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------+--------------------------------------------------------------+---------------------------------------+\nonly showing top 10 rows\n\n\n\n\n\n[Stage 18:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n+-----------+--------------------+-----+------------------+\n|AFFILIATION|  MIN_EDULEVELS_NAME|count|        avg_salary|\n+-----------+--------------------+-----+------------------+\n|       Blue|Ph.D. or professi...|   13|114372.30769230769|\n|       Blue|     Master's degree|  367| 122253.1553133515|\n|        Red|Ph.D. or professi...|   11|105201.45454545454|\n|       Blue| No Education Listed|  942|125017.12101910828|\n|       Blue|    Associate degree|  203|          133256.0|\n|        Red|  High school or GED|  114|104949.07894736843|\n|       Blue|  High school or GED|  128|    111645.7265625|\n|       Blue|   Bachelor's degree| 3582|121041.59491903965|\n|        Red|   Bachelor's degree| 3632|116541.23595814977|\n|        Red| No Education Listed|  841|113824.22948870392|\n|        Red|     Master's degree|  221|119314.45248868778|\n|        Red|    Associate degree|  290|130392.43793103448|\n+-----------+--------------------+-----+------------------+\n\n\n\n[Stage 21:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n                                                    \n\n\nThis figure shows us the number of postings just with certain key words related to AI. It groups by education level and political affiliation. The graph tells us that the distribution of number of AI job postings across education level and affiliation mirrors that of the larger data set. Thus, AI jobs are not posted at any higher frequency across red or blue states than any other job.\n\n\n                                                    \n\n\nSimilarly, in this figure, AI Jobs show salary distributions equivalent to that of jobs in other industries. Like the general analysis, blue states offer higher salaries for AI jobs across each of education levels. Again, this is likely due to the higher cost of living in most blue states.\n\n\n[Stage 24:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n+------------------+-----------+-----+------------------+\n|STATE_ABBREVIATION|AFFILIATION|count|avg_salary        |\n+------------------+-----------+-----+------------------+\n|CA                |Blue       |1058 |130800.25141776938|\n|TX                |Red        |1045 |119186.34354066986|\n|NY                |Blue       |617  |118399.72609400324|\n|VA                |Blue       |598  |116501.39632107023|\n|IL                |Blue       |480  |120063.675        |\n|FL                |Red        |447  |115597.10514541387|\n|GA                |Red        |419  |111773.3723150358 |\n|NC                |Red        |372  |117288.66935483871|\n|OH                |Red        |362  |114862.99171270718|\n|PA                |Red        |338  |118117.09467455621|\n+------------------+-----------+-----+------------------+\nonly showing top 10 rows\n\n\n\n[Stage 27:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n                                                    \n\n\n\n\n[Stage 35:&gt;                                                         (0 + 1) / 1][Stage 35:&gt;                 (0 + 1) / 1][Stage 36:&gt;                 (0 + 1) / 1][Stage 35:&gt;   (0 + 1) / 1][Stage 36:&gt;   (0 + 1) / 1][Stage 37:&gt;   (0 + 0) / 1][Stage 37:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n\n\n\n\n\n\n\nIndustry\ncount\nNAICS_Level\n\n\n\n\n0\nComputer Systems Design and Related Services\n1554\nNAICS4_NAME\n\n\n1\nComputer Systems Design and Related Services\n1554\nNAICS5_NAME\n\n\n2\nManagement, Scientific, and Technical Consulti...\n827\nNAICS4_NAME\n\n\n3\nComputer Systems Design Services\n689\nNAICS6_NAME\n\n\n4\nCustom Computer Programming Services\n647\nNAICS6_NAME\n\n\n...\n...\n...\n...\n\n\n59\nArchitectural Services\n2\nNAICS6_NAME\n\n\n60\nPublic Relations Agencies\n2\nNAICS6_NAME\n\n\n61\nTranslation and Interpretation Services\n2\nNAICS6_NAME\n\n\n62\nDirect Mail Advertising\n1\nNAICS5_NAME\n\n\n63\nDirect Mail Advertising\n1\nNAICS6_NAME\n\n\n\n\n64 rows × 3 columns"
  },
  {
    "objectID": "skill_gap_analysis.html",
    "href": "skill_gap_analysis.html",
    "title": "Skills Gap Analysis",
    "section": "",
    "text": "Setting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n25/10/11 16:17:31 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n25/10/11 16:17:32 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.\n[Stage 1:&gt;                                                          (0 + 1) / 1]                                                                                25/10/11 16:17:42 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.\n\n\n\n\n\n\n\n\n\n\n\nPython\nJava\nSQL\nPower BI\nMachine Learning\nCloud Computing\n\n\nName\n\n\n\n\n\n\n\n\n\n\nEmily\n2\n2\n2\n4\n1\n2\n\n\nPranathi\n1\n1\n1\n4\n1\n2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Stage 2:&gt;                                                          (0 + 1) / 1]                                                                                \n\n\n\n\n\n\n\n\n\nPython\nJava\nSQL\nPower BI\nMachine Learning\nCloud Computing\n\n\nName\n\n\n\n\n\n\n\n\n\n\nEmily\n2\n2\n2\n4\n1\n2\n\n\nPranathi\n1\n1\n1\n4\n1\n2\n\n\nJob Postings Count\n12350\n4470\n0\n10850\n4324\n2555\n\n\n\n\n\n\n\nBased on our Skills Gap Analysis, we need to work on our Python skills. In order to be more competitive in the job market, we will finish the Python DataCamp and practice incorporating our new skills into our current roles."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Gender Disparities in Hiring & Political Influence",
    "section": "",
    "text": "This research investigates the intersection of gender-based employment patterns and political geography in the United States.\n\n\n\n\nWe analyze gender representation and hiring trends across multiple sectors:\n\nTechnology Sector: Software development, AI/ML, data science\nHealthcare: Medical professionals, administrative roles\nFinance: Banking, investment, fintech\nManufacturing: Production, engineering, management\nService Industries: Retail, hospitality, education\n\nKey metrics examined: - Hiring rates by gender - Retention rates - Promotion patterns - Industry-specific barriers\n\n\n\nExamining state-level political affiliations and their relationship with:\n\nRed States (Conservative-leaning)\n\nGender hiring ratios\nWorkplace policies\nWage structures\n\nBlue States (Liberal-leaning)\n\nGender hiring ratios\nWorkplace policies\nWage structures\n\nSwing States: Comparative analysis of mixed political environments\n\n\n\n\nFocused investigation on the technology sector, specifically:\n\nAI and Machine Learning roles\n\nData scientists\nML engineers\nAI researchers\n\nWomen’s representation comparison:\n\nConservative states (red states)\nLiberal states (blue states)\nNational averages\n\nFactors analyzed:\n\nEducational pipeline differences\nCompany culture and policies\nState-level STEM initiatives\nIndustry concentration by state\n\n\n\n\n\nComprehensive wage analysis examining:\n\nGender wage gaps across:\n\nRed states\nBlue states\nSwing states\n\nIndustry-specific wage disparities:\n\nTech and AI fields\nHealthcare\nFinance\nManufacturing\n\nControlling for:\n\nExperience level\nEducation\nJob title/role\nCompany size\nCost of living adjustments\n\nPolitical affiliation impact:\n\nState minimum wage policies\nEqual pay legislation\nWorkplace protection laws\n\n\n\n\n\n\nWe expect this analysis will reveal that political geography influences gender-based employment outcomes, particularly in emerging high-wage sectors such as AI and technology.\n\n\n\n[Your data sources and analytical methods will go here]\n\n\n\n[Interactive charts and graphs will be added here]\n\n\n\n[Research findings will be presented here]"
  },
  {
    "objectID": "index.html#research-questions",
    "href": "index.html#research-questions",
    "title": "Gender Disparities in Hiring & Political Influence",
    "section": "",
    "text": "We analyze gender representation and hiring trends across multiple sectors:\n\nTechnology Sector: Software development, AI/ML, data science\nHealthcare: Medical professionals, administrative roles\nFinance: Banking, investment, fintech\nManufacturing: Production, engineering, management\nService Industries: Retail, hospitality, education\n\nKey metrics examined: - Hiring rates by gender - Retention rates - Promotion patterns - Industry-specific barriers\n\n\n\nExamining state-level political affiliations and their relationship with:\n\nRed States (Conservative-leaning)\n\nGender hiring ratios\nWorkplace policies\nWage structures\n\nBlue States (Liberal-leaning)\n\nGender hiring ratios\nWorkplace policies\nWage structures\n\nSwing States: Comparative analysis of mixed political environments\n\n\n\n\nFocused investigation on the technology sector, specifically:\n\nAI and Machine Learning roles\n\nData scientists\nML engineers\nAI researchers\n\nWomen’s representation comparison:\n\nConservative states (red states)\nLiberal states (blue states)\nNational averages\n\nFactors analyzed:\n\nEducational pipeline differences\nCompany culture and policies\nState-level STEM initiatives\nIndustry concentration by state\n\n\n\n\n\nComprehensive wage analysis examining:\n\nGender wage gaps across:\n\nRed states\nBlue states\nSwing states\n\nIndustry-specific wage disparities:\n\nTech and AI fields\nHealthcare\nFinance\nManufacturing\n\nControlling for:\n\nExperience level\nEducation\nJob title/role\nCompany size\nCost of living adjustments\n\nPolitical affiliation impact:\n\nState minimum wage policies\nEqual pay legislation\nWorkplace protection laws"
  },
  {
    "objectID": "index.html#expected-findings",
    "href": "index.html#expected-findings",
    "title": "Gender Disparities in Hiring & Political Influence",
    "section": "",
    "text": "We expect this analysis will reveal that political geography influences gender-based employment outcomes, particularly in emerging high-wage sectors such as AI and technology."
  },
  {
    "objectID": "index.html#methodology",
    "href": "index.html#methodology",
    "title": "Gender Disparities in Hiring & Political Influence",
    "section": "",
    "text": "[Your data sources and analytical methods will go here]"
  },
  {
    "objectID": "index.html#data-visualizations",
    "href": "index.html#data-visualizations",
    "title": "Gender Disparities in Hiring & Political Influence",
    "section": "",
    "text": "[Interactive charts and graphs will be added here]"
  },
  {
    "objectID": "index.html#conclusions",
    "href": "index.html#conclusions",
    "title": "Gender Disparities in Hiring & Political Influence",
    "section": "",
    "text": "[Research findings will be presented here]"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About This Project",
    "section": "",
    "text": "This project examines the complex relationship between gender disparities in employment, hiring patterns, wage gaps, and political geography across the United States. We pay particular attention to representation in AI and technology fields."
  },
  {
    "objectID": "about.html#research-focus",
    "href": "about.html#research-focus",
    "title": "About This Project",
    "section": "",
    "text": "This project examines the complex relationship between gender disparities in employment, hiring patterns, wage gaps, and political geography across the United States. We pay particular attention to representation in AI and technology fields."
  },
  {
    "objectID": "about.html#our-four-core-questions",
    "href": "about.html#our-four-core-questions",
    "title": "About This Project",
    "section": "Our Four Core Questions",
    "text": "Our Four Core Questions\n\nHiring Patterns: How do men and women fare differently in hiring across various industries?\nPolitical Geography: Do employment disparities correlate with state political affiliations (red vs. blue states)?\nAI Sector Focus: Is women’s underrepresentation in AI fields more pronounced in conservative states?\nWage Analysis: How do gender wage gaps vary across different political contexts?"
  },
  {
    "objectID": "about.html#why-this-matters",
    "href": "about.html#why-this-matters",
    "title": "About This Project",
    "section": "Why This Matters",
    "text": "Why This Matters\n\nAI and tech sectors are rapidly growing and high-paying\nPolitical policies at state level impact workplace equality\nUnderstanding regional differences can inform policy decisions\nIdentifying barriers helps create targeted interventions"
  },
  {
    "objectID": "about.html#methodology",
    "href": "about.html#methodology",
    "title": "About This Project",
    "section": "Methodology",
    "text": "Methodology\nOur analysis will include:\n\nData Sources:\n\nBureau of Labor Statistics employment data\nState-level political affiliation data\nIndustry-specific hiring and salary information\nAI/tech sector demographics\n\nAnalytical Approach:\n\nStatistical analysis of hiring patterns\nGeographic mapping of disparities\nCorrelation analysis between political affiliation and employment outcomes\nComparative analysis across industries"
  },
  {
    "objectID": "about.html#team",
    "href": "about.html#team",
    "title": "About This Project",
    "section": "Team",
    "text": "Team\nGroup 8 - AD 688 Web Analytics\n\nPranathi Nagasai\nEmily Sundberg"
  },
  {
    "objectID": "about.html#course-information",
    "href": "about.html#course-information",
    "title": "About This Project",
    "section": "Course Information",
    "text": "Course Information\nBoston University Metropolitan College\nAD 688: Web Analytics\nFall 2025"
  },
  {
    "objectID": "about.html#timeline",
    "href": "about.html#timeline",
    "title": "About This Project",
    "section": "Timeline",
    "text": "Timeline\n\nData collection and cleaning\nExploratory data analysis\nStatistical modeling\nVisualization development\nFinal report and presentation"
  },
  {
    "objectID": "data_cleaning.html",
    "href": "data_cleaning.html",
    "title": "Data Cleaning",
    "section": "",
    "text": "Load the dataset\n\nimport pandas as pd\nimport plotly.express as px\nimport plotly.io as pio\nfrom pyspark.sql import SparkSession\nimport re\nimport numpy as np\nimport plotly.graph_objects as go\nfrom pyspark.sql.functions import col, split, explode, regexp_replace, transform, when\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.functions import col, monotonically_increasing_id\n\nnp.random.seed(42)\n\npio.renderers.default = \"notebook\"\n\nspark = SparkSession.builder.appName(\"LightcastData\").getOrCreate()\n\njobs_df = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").option(\"multiLine\",\"true\").option(\"escape\", \"\\\"\").csv(\"./data/lightcast_job_postings.csv\")\njobs_df.createOrReplaceTempView(\"job_postings\")\n\nelections_df = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").option(\"multiLine\",\"true\").option(\"escape\", \"\\\"\").csv(\"./data/2024_election_results.csv\")\nelections_df.createOrReplaceTempView(\"election_results\")\n\n#print(\"---This is Diagnostic check, No need to print it in the final doc---\")\n\n#df.printSchema() # comment this line when rendering the submission\n#jobs_df.show(5)\n#elections_df.show(5)\n\n\n\nData Cleaning\n\n# casting corrected variable type\njobs_df = jobs_df.withColumn(\"SALARY_FROM\", col (\"SALARY_FROM\").cast(\"float\"))\\\n  .withColumn(\"SALARY_TO\", col(\"SALARY_TO\").cast(\"float\")) \\\n  .withColumn(\"MAX_YEARS_EXPERIENCE\", col(\"MAX_YEARS_EXPERIENCE\").cast(\"float\"))\\\n  .withColumn(\"MIN_YEARS_EXPERIENCE\", col(\"MIN_YEARS_EXPERIENCE\").cast(\"float\"))\\\n  .withColumn(\"SALARY\", col(\"SALARY\").cast(\"float\"))\n\n# Clean Up Columns\njobs_df = jobs_df.withColumn(\"EDUCATION_LEVELS_NAME\", regexp_replace(col(\"EDUCATION_LEVELS_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"SOURCE_TYPES\", regexp_replace(col(\"SOURCE_TYPES\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"SOURCES\", regexp_replace(col(\"SOURCES\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"SKILLS\", regexp_replace(col(\"SKILLS\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"SKILLS_NAME\", regexp_replace(col(\"SKILLS_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"SPECIALIZED_SKILLS_NAME\", regexp_replace(col(\"SPECIALIZED_SKILLS_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"CERTIFICATIONS_NAME\", regexp_replace(col(\"CERTIFICATIONS_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"COMMON_SKILLS_NAME\", regexp_replace(col(\"COMMON_SKILLS_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"SOFTWARE_SKILLS_NAME\", regexp_replace(col(\"SOFTWARE_SKILLS_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"CIP6_NAME\", regexp_replace(col(\"CIP6_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"CIP4_NAME\", regexp_replace(col(\"CIP4_NAME\"), \"[\\n\\r]\", \"\"))\njobs_df = jobs_df.withColumn(\"CIP2_NAME\", regexp_replace(col(\"CIP2_NAME\"), \"[\\n\\r]\", \"\"))\n\n\n# Compute and impute Median Salary\ndef compute_median(sdf, col_name):\n  q = sdf.approxQuantile(col_name, [0.5], 0.01)\n  return q[0] if q else None\n\n\nmedian_from = compute_median(jobs_df, \"SALARY_FROM\")\nmedian_to = compute_median(jobs_df, \"SALARY_TO\")\nmedian_salary = compute_median(jobs_df, \"SALARY\")\n\nprint(\"Medians:\", median_from, median_to, median_salary)\n\njobs_df = jobs_df.fillna({\n  \"SALARY_FROM\": median_from,\n  \"SALARY_TO\": median_to,\n  \"SALARY\": median_salary\n})\n\nfrom pyspark.sql.functions import col\njobs_df = jobs_df.withColumn(\n    \"MIDPOINT_SALARY\",\n    (col(\"SALARY_TO\") + col(\"SALARY_FROM\")) / 2\n)\n\n# Dropping unnecessary columns\ncolumns_to_drop = [\n    \"ID\", \"URL\", \"ACTIVE_URLS\", \"DUPLICATES\", \"LAST_UPDATED_TIMESTAMP\",\"STATE\",\"COUNTY_OUTGOING\",\"COUNTY_INCOMMING\",\"MSA_OUTGOING\",\"MSA_INCOMING\",\n    \"NAICS2\", \"NAICS3\", \"NAICS4\", \"NAICS5\", \"NAICS6\", \"ONET\",\"ONET_2019\",\"CIP6\",\"CIP4\",\"CIP2\",\"SOC_2021_2\",\"SOC_2021_3\",\"SOC_2021_4\",\"SOC_2021_5\",\"SOC_2\", \"SOC_3\", \"SOC_4\",\"SOC_5\", \"NAICS_2022_2\",\"NAICS_2022_3\",\"NAICS_2022_4\",\"NAICS_2022_5\",\"NAICS_2022_6\",\"CITY\",\"COUNTY\",\"MSA\",\"COUNTY_INCOMING\"\n]\njobs_df = jobs_df.drop(*columns_to_drop)\n\n# configuring remote work groups\nfrom pyspark.sql.functions import when, col, trim\n\njobs_df = jobs_df.withColumn(\"REMOTE_GROUP\",\n  when(trim(col(\"REMOTE_TYPE_NAME\"))== \"Remote\", \"Remote\")\n  .when(trim(col(\"REMOTE_TYPE_NAME\"))== \"Hybrid Remote\", \"Hybrid\")\n  .when(trim(col(\"REMOTE_TYPE_NAME\"))== \"Not Remote\", \"Onsite\")\n  .when(col(\"REMOTE_TYPE_NAME\").isNull(), \"Onsite\")\n  .otherwise(\"Onsite\")\n)\n\n# dropping any duplicate postings\njobs_df = jobs_df.dropDuplicates([\"TITLE\", \"COMPANY\", \"LOCATION\", \"POSTED\"])\n\n# handling missing data\nfrom pyspark.sql.functions import col, when, sum as spark_sum\n\ntotal_rows = jobs_df.count()\nmissing_threshold = total_rows * 0.5\nnull_counts = jobs_df.select([\n    (spark_sum(col(c).isNull().cast(\"int\"))).alias(c) for c in jobs_df.columns\n]).collect()[0].asDict()\ncolumns_to_keep = [c for c, nulls in null_counts.items() if nulls &lt;= missing_threshold or c == \"SALARY\"]\njobs_df = jobs_df.select(columns_to_keep)\n\n#jobs_df.show(15)\n\n\nfrom pyspark.sql import functions as F\n\njobs_df = jobs_df.withColumn(\"STATE_ABBREVIATION\", F.trim(F.split(jobs_df[\"COUNTY_NAME\"], \",\").getItem(1)))\n\njobs_alias = jobs_df.alias(\"jobs\")\nelections_alias = elections_df.alias(\"elections\")\n\njobs_df = jobs_alias.join(\n    elections_alias,\n    F.col(\"jobs.STATE_ABBREVIATION\") == F.col(\"elections.STATE\"),\n    \"left\"\n)\njobs_df = jobs_df.drop(F.col(\"elections.STATE\"))\n\njobs_df = jobs_df.withColumnRenamed(\"Affiliation\", \"AFFILIATION\")\n\n#jobs_df.show(15)\n\n\nselected_df = jobs_df.select(\n  \"EDUCATION_LEVELS_NAME\",\n  \"MIN_EDULEVELS_NAME\",\n  \"EMPLOYMENT_TYPE_NAME\",\n  \"MIN_YEARS_EXPERIENCE\",\n  \"SALARY_TO\",\n  \"SALARY_FROM\",\n  \"SALARY\",\n  \"CITY_NAME\",\n  \"MSA_NAME\",\n  \"STATE_NAME\",\n  \"NAICS2_NAME\",\n  \"NAICS3_NAME\",\n  \"NAICS4_NAME\",\n  \"NAICS5_NAME\",\n  \"NAICS6_NAME\",\n  \"SKILLS_NAME\",\n  \"SPECIALIZED_SKILLS_NAME\",\n  \"CERTIFICATIONS_NAME\",\n  \"COMMON_SKILLS_NAME\",\n  \"SOFTWARE_SKILLS_NAME\",\n  \"ONET_NAME\",\n  \"LOT_CAREER_AREA_NAME\",\n  \"LOT_OCCUPATION_NAME\",\n  \"LOT_SPECIALIZED_OCCUPATION_NAME\",\n  \"LOT_OCCUPATION_GROUP_NAME\",\n  \"LOT_V6_SPECIALIZED_OCCUPATION_NAME\",\n  \"LOT_V6_OCCUPATION_NAME\",\n  \"LOT_V6_OCCUPATION_GROUP_NAME\",\n  \"LOT_V6_CAREER_AREA_NAME\",\n  \"SOC_2_NAME\",\n  \"SOC_3_NAME\",\n  \"SOC_4_NAME\",\n  \"SOC_5_NAME\",\n  \"REMOTE_GROUP\",\n  \"STATE_ABBREVIATION\",\n  \"AFFILIATION\",\n  \"MIDPOINT_SALARY\"\n)\n\n\nimport pandas as pd\nfrom pyspark.sql.functions import col, sum as spark_sum, when, trim, length\nimport hvplot.pandas\n\n\ndf_sample = selected_df.sample(fraction = .05, seed = 42).toPandas()\n\nmissing_mask = df_sample.isnull()\n\nmissing_long = (\n  missing_mask.reset_index()\n  .melt(id_vars = \"index\", var_name = \"column\", value_name = \"is_missing\")\n)\n\nmissing_long[\"is_missing\"] = missing_long[\"is_missing\"].astype(int)\n\nmissing = missing_long.hvplot.heatmap(\n  x=\"column\",\n  y=\"index\",\n  C = \"is_missing\",\n  cmap = \"Blues\",\n  width = 900,\n  height = 500,\n  title = \"Heatmap of Missing Values (5%)\"\n).opts(xrotation=45)\n\nhvplot.save(missing, './output/missing_heatmap.html')\n\n\n\nfrom pyspark.sql.functions import countDistinct\n\nselected_df.select([\n  countDistinct(c).alias(c+\"_nunique\")\n  for c in selected_df.columns\n]).show(truncate=False)\n\n# Education Levels\n\nselected_df = selected_df.withColumn(\n  \"EDUCATION_LEVELS_NAME\",\n    when(col(\"EDUCATION_LEVELS_NAME\").isNull(), \"No Education Listed\")\n    .otherwise(col(\"EDUCATION_LEVELS_NAME\"))\n)\n\n# Min Edu Levels\n\nselected_df = selected_df.withColumn(\n  \"MIN_EDULEVELS_NAME\",\n    when(col(\"MIN_EDULEVELS_NAME\").isNull(), \"No Education Listed\")\n    .otherwise(col(\"MIN_EDULEVELS_NAME\"))\n)\n\n# Employment Type Name\n\nselected_df = selected_df.withColumn(\n  \"EMPLOYMENT_TYPE_NAME\",\n    when(col(\"EMPLOYMENT_TYPE_NAME\") == \"Part-time / full-time\",\"Flexible\")\n    .when(col(\"EMPLOYMENT_TYPE_NAME\") == \"Part-time (â‰¤ 32 hours)\",\"Part-Time\")\n    .when(col(\"EMPLOYMENT_TYPE_NAME\") == \"Full-time (&gt; 32 hours)\",\"Full-Time\")\n    .when(col(\"EMPLOYMENT_TYPE_NAME\").isNull(), \"Full-Time\")\n    .otherwise(col(\"EMPLOYMENT_TYPE_NAME\"))\n)\n\n# Min Years Experience\nselected_df = selected_df.withColumn(\n    \"MIN_YEARS_EXPERIENCE\",\n    when(col(\"MIN_YEARS_EXPERIENCE\").isNull(), 0)\n    .otherwise(col(\"MIN_YEARS_EXPERIENCE\"))\n)\n\n# Salary to\nselected_df = selected_df.withColumn(\n    \"SALARY_TO\",\n    when(col(\"SALARY_TO\").isNull(), median_to)\n    .otherwise(col(\"SALARY_TO\"))\n)\n\n# Salary from\nselected_df = selected_df.withColumn(\n    \"SALARY_FROM\",\n    when(col(\"SALARY_FROM\").isNull(), median_from)\n    .otherwise(col(\"SALARY_FROM\"))\n)\n\n# Salary \nselected_df = selected_df.withColumn(\n    \"SALARY\",\n    when(col(\"SALARY\").isNull(), median_salary)\n    .otherwise(col(\"SALARY\"))\n)\n\n# City Name\nselected_df = selected_df.withColumn(\n  \"CITY_NAME\",\n    when(col(\"CITY_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"CITY_NAME\"))\n)\n\n# MSA Name\nselected_df = selected_df.withColumn(\n  \"MSA_NAME\",\n    when(col(\"MSA_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"MSA_NAME\"))\n)\n\n# State Name\nselected_df = selected_df.withColumn(\n  \"STATE_NAME\",\n    when(col(\"STATE_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"STATE_NAME\"))\n)\n\n# NAICS2_NAME \nselected_df = selected_df.withColumn(\n  \"NAICS2_NAME\",\n    when(col(\"NAICS2_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"NAICS2_NAME\"))\n)\n\n# NAICS3_NAME \nselected_df = selected_df.withColumn(\n  \"NAICS3_NAME\",\n    when(col(\"NAICS3_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"NAICS3_NAME\"))\n)\n\n# NAICS4_NAME \nselected_df = selected_df.withColumn(\n  \"NAICS4_NAME\",\n    when(col(\"NAICS4_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"NAICS4_NAME\"))\n)\n\n# NAICS5_NAME \nselected_df = selected_df.withColumn(\n  \"NAICS5_NAME\",\n    when(col(\"NAICS5_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"NAICS5_NAME\"))\n)\n\n# NAICS6_NAME \nselected_df = selected_df.withColumn(\n  \"NAICS6_NAME\",\n    when(col(\"NAICS6_NAME\").isNull(), \"Unknown\")\n    .otherwise(col(\"NAICS6_NAME\"))\n)\n\n#STATE ABBREVIATION\nselected_df = selected_df.withColumn(\n  \"STATE_ABBREVIATION\",\n    when(col(\"STATE_ABBREVIATION\").isNull(), \"Unknown\")\n    .otherwise(col(\"STATE_ABBREVIATION\"))\n)\n\n\npdf = selected_df.toPandas()\n\npdf.to_csv(\"./data/lightcast_cleaned.csv\", index=False)\n\npdf.head(15)\n\nprint(\"Data Cleaning Complete. Rows retained:\", len(pdf))"
  }
]